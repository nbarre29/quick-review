
# Chain of Responsibility

**Idea:** You have a sequence of handlers. Each handler decides: *handle the request* or *pass it to the next handler*. This decouples the sender from the exact receiver and keeps each step simple.

## Example: Purchase Approval Chain

A purchase request must be approved by a Manager (≤ $1,000), else a Director (≤ $10,000), else a VP (anything above).


public class PurchaseRequest {
    private final double amount;
    private final String description;

    public PurchaseRequest(double amount, String description) {
        this.amount = amount;
        this.description = description;
    }

    public double getAmount() {
        return amount;
    }

    public String getDescription() {
        return description;
    }
}

#### MyNotes: Convert to record class
public record PurchaseRequest(double amount, String description) {
}


/** Handler interface */
public interface Approver {
    Approver setNext(Approver next);
    void handle(PurchaseRequest req);
}


/** Base class to share chaining logic */
public abstract class BaseApprover implements Approver {
    private Approver next;

    @Override
    public Approver setNext(Approver next) {
        this.next = next;
        return next;      // fluent chaining
    }

    protected void passToNext(PurchaseRequest req) {
        if (next != null) {
            next.handle(req);
        } else {
            System.out.println("No approver available for: " + req.getDescription()
                    + " ($" + req.getAmount() + ")");
        }
    }
}

/** Concrete handlers */
public class Manager extends BaseApprover {
    @Override
    public void handle(PurchaseRequest req) {
        if (req.getAmount() <= 1_000) {
            System.out.println("Manager approved: " + req.getDescription());
        } else {
            passToNext(req);
        }
    }
}

public class Director extends BaseApprover {
    @Override
    public void handle(PurchaseRequest req) {
        if (req.getAmount() <= 10_000) {
            System.out.println("Director approved: " + req.getDescription());
        } else {
            passToNext(req);
        }
    }
}

public class VicePresident extends BaseApprover {
    @Override
    public void handle(PurchaseRequest req) {
        // VP approves anything above Director's limit
        System.out.println("VP approved: " + req.getDescription()
                + " ($" + req.getAmount() + ")");
    }
}

/** Demo */
public class ApprovalChainDemo {
    public static void main(String[] args) {
        Approver manager = new Manager();
        Approver director = new Director();
        Approver vp = new VicePresident();

        // Build the chain: Manager -> Director -> VP
        manager.setNext(director).setNext(vp);

        // Test requests
        manager.handle(new PurchaseRequest(300, "Office supplies"));
        manager.handle(new PurchaseRequest(5_000, "Team laptops"));
        manager.handle(new PurchaseRequest(50_000, "Data center hardware"));
    }
}


**Output :**

Manager approved: Office supplies
Director approved: Team laptops
VP approved: Data center hardware ($50000.0)



## When to use it

* Validation/processing pipelines (auth → input validation → business rules → persistence).
* Logging/monitoring chains (DEBUG → INFO → WARN → ERROR).
* Support/escalation flows (Tier 1 → Tier 2 → SME).

## Benefits

* Open/Closed: add a new handler without touching others.
* Separation of concerns: each handler does one thing well.
* Flexible ordering: rearrange or configure chains at runtime.

## Gotchas

* If no handler consumes the request, decide what should happen (fail fast, default handler, or explicit error).
* Don’t let chains get too long—group related steps.
_____________________________________________________________________________________________________

==> Using Claude Sonnet 4.5 from Github Copilot:

# Chain of Responsibility Pattern Example

The Chain of Responsibility pattern passes a request along a chain of handlers. Each handler decides either to process the request or pass it to the next handler.

## Handler Interface

```java
public interface SupportHandler {
    void setNext(SupportHandler handler);
    void handleRequest(SupportRequest request);
}
```

## Support Request Class

```java
public class SupportRequest {
    private final String issue;
    private final int priority;

    public SupportRequest(String issue, int priority) {
        this.issue = issue;
        this.priority = priority;
    }

    public String getIssue() {
        return issue;
    }

    public int getPriority() {
        return priority;
    }
}
```

## Concrete Handlers

```java
public class Level1Support implements SupportHandler {
    private SupportHandler nextHandler;

    @Override
    public void setNext(SupportHandler handler) {
        this.nextHandler = handler;
    }

    @Override
    public void handleRequest(SupportRequest request) {
        if (request.getPriority() <= 1) {
            System.out.println("Level 1 Support handled: " + request.getIssue());
        } else if (nextHandler != null) {
            nextHandler.handleRequest(request);
        }
    }
}
```

```java
public class Level2Support implements SupportHandler {
    private SupportHandler nextHandler;

    @Override
    public void setNext(SupportHandler handler) {
        this.nextHandler = handler;
    }

    @Override
    public void handleRequest(SupportRequest request) {
        if (request.getPriority() == 2) {
            System.out.println("Level 2 Support handled: " + request.getIssue());
        } else if (nextHandler != null) {
            nextHandler.handleRequest(request);
        }
    }
}
```

```java
public class Level3Support implements SupportHandler {
    private SupportHandler nextHandler;

    @Override
    public void setNext(SupportHandler handler) {
        this.nextHandler = handler;
    }

    @Override
    public void handleRequest(SupportRequest request) {
        if (request.getPriority() >= 3) {
            System.out.println("Level 3 Support handled: " + request.getIssue());
        }
    }
}
```

## Usage Example

```java
public class ChainOfResponsibilityDemo {
    public static void main(String[] args) {
        // Create handlers
        SupportHandler level1 = new Level1Support();
        SupportHandler level2 = new Level2Support();
        SupportHandler level3 = new Level3Support();

        // Build the chain
        level1.setNext(level2);
        level2.setNext(level3);

        // Create requests
        SupportRequest request1 = new SupportRequest("Password reset", 1);
        SupportRequest request2 = new SupportRequest("Software installation", 2);
        SupportRequest request3 = new SupportRequest("System crash", 3);

        // Process requests through the chain
        level1.handleRequest(request1);
        level1.handleRequest(request2);
        level1.handleRequest(request3);
    }
}
```

Output:
Level 1 Support handled: Password reset
Level 2 Support handled: Software installation
Level 3 Support handled: System crash

This example demonstrates a support ticket system where requests are handled by different support levels based on priority. Each handler checks if it can handle the request, otherwise passes it to the next handler in the chain.

_____________________________________________________________________________________________________